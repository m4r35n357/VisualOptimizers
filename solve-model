#!/bin/sh
#
# Runs a specified model against all optimizers

GRY='\e[1;30m'
MGT='\e[0;35m'
NRM='\e[0m'

args="$0 $*"
n_args=$(($# + 1))
printf "${GRY}args ${NRM}%s${GRY} [ ${MGT}%s${GRY} ]${NRM}\n" $n_args "$args" >&2

model=$1
order=$2
agents=$3
iterations=$4
lower=$5
upper=$6

if [ $order -ge 8 ]
then
    adaptive=1
else
    adaptive=0
fi

# Nelder-Mead
./nm-$model-std 3 0 $order 1.0e-6 $(((agents - 1) * iterations + agents)) \
    $(printf "scale=3; 0.5 * ($upper - $lower);\n" | /usr/bin/bc) $adaptive 2 $lower $upper >/dev/null

# Un-clamped
./cut-$model-std 3 0 $order $agents $iterations 0 $lower $upper >/dev/null

# Clamped
./cut-$model-std 3 0 $order $agents $iterations 1 $lower $upper >/dev/null

if [ $order -le 8 ]
then
    # Periodic Descent Direction Setting
    ./spiral-$model-std 3 0 $order $agents $iterations 0 $lower $upper >/dev/null

    # Convergence Setting
    ./spiral-$model-std 3 0 $order $agents $iterations 1 $lower $upper >/dev/null

    # Base-line
    ./rnd-$model-std 3 0 $order $(((agents - 1) * iterations + agents)) $lower $upper >/dev/null
fi
